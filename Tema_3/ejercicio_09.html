<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ejercicio_09</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="ejercicio_09_files/libs/clipboard/clipboard.min.js"></script>
<script src="ejercicio_09_files/libs/quarto-html/quarto.js"></script>
<script src="ejercicio_09_files/libs/quarto-html/popper.min.js"></script>
<script src="ejercicio_09_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ejercicio_09_files/libs/quarto-html/anchor.min.js"></script>
<link href="ejercicio_09_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ejercicio_09_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ejercicio_09_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ejercicio_09_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ejercicio_09_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="ejercicio-9" class="level1">
<h1>Ejercicio 9</h1>
<p>Genera aleatoriamente una variable regresora <span class="math inline">\(X\)</span> y un vector aleatorio <span class="math inline">\(\epsilon\)</span> de longitud <span class="math inline">\(n = 100\)</span>, con distribución normal estándar e independientes.</p>
<p>Genera la variable respuesta de acuerdo con el modelo: <span class="math display">\[
Y = X + X^2 + X^3 + \epsilon.
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ramify)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ramify'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    flatten</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    clip</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>X_distribution <span class="ot">&lt;-</span> rnorm </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>error_distribution <span class="ot">&lt;-</span> rnorm</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>modelo_1 <span class="ot">&lt;-</span> <span class="cf">function</span> (x) {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (x <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>Y_distribution <span class="ot">&lt;-</span> <span class="cf">function</span> (n, t){</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">X_distribution</span>(n)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> <span class="fu">error_distribution</span>(n)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">sapply</span>(x, t) <span class="sc">+</span> e)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>Y_1 <span class="ot">&lt;-</span> <span class="fu">Y_distribution</span>(n, modelo_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">X_distribution</span>(n)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generamos las potencias</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">'X'</span> <span class="ot">=</span> X)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#datos[1] &lt;- X</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  datos[i] <span class="ot">&lt;-</span> datos[<span class="dv">1</span>]<span class="sc">*</span>datos[i<span class="dv">-1</span>]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo1 </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">as.list</span>(datos[<span class="dv">1</span>]<span class="sc">+</span>datos[<span class="dv">2</span>] <span class="sc">+</span> datos[<span class="dv">3</span>] <span class="sc">+</span> <span class="fu">error_distribution</span>(n)))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span><span class="st">'Y'</span> <span class="ot">&lt;-</span> Y</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>datos2 <span class="ot">&lt;-</span> datos</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>nombre_variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'X1'</span>, <span class="st">'X2'</span>,  <span class="st">'X3'</span>, <span class="st">'X4'</span>, <span class="st">'X5'</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'X6'</span>,  <span class="st">'X7'</span>, <span class="st">'X8'</span>, <span class="st">'X9'</span>, <span class="st">'X10'</span>, <span class="st">'y'</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos) <span class="ot">&lt;-</span> nombre_variables</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos2) <span class="ot">&lt;-</span> nombre_variables</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>datos2<span class="sc">$</span><span class="st">'Y_ideal'</span> <span class="ot">&lt;-</span> <span class="fu">sapply</span>(X, <span class="cf">function</span>(x)(x<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">+</span> x))))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos2) <span class="sc">+</span> </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(X, Y), <span class="at">colour =</span> <span class="st">'black'</span> ) <span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X, Y_ideal), <span class="at">colour =</span> <span class="st">'red'</span> ) <span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Muestra ruidosa y función ideal'</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="selecciona-el-modelo-óptimo" class="level2">
<h2 class="anchored" data-anchor-id="selecciona-el-modelo-óptimo">Selecciona el modelo óptimo</h2>
<p>Entre todos los submodelos que contienen como variables regresoras <span class="math inline">\(X, X^2, X^3, \ldots, X^{10}\)</span>. ¿Cuál es el mejor modelo de acuerdo con los criterios <span class="math inline">\(C_p\)</span>, BIC y <span class="math inline">\(R_a^2\)</span>?</p>
<p><strong>Solución</strong></p>
<p>Para poder realizar estas comparaciones utilizaremos la función <a href="https://www.rdocumentation.org/packages/leaps/versions/3.1/topics/regsubsets"><code>leaps::regsubsets</code></a>.</p>
<p>Donde los argumentos que nos interesan son:</p>
<ul>
<li><code>datos</code><br>
</li>
<li><code>method</code> donde indicaremos de si se trata de <code>exhaustive</code> o <code>forward</code>.<br>
</li>
<li><code>nvmax</code> número máximo de subconjuntos a examinar, la pondremos al máximo de parámetros que tenemos.</li>
<li><code>intercept</code> Si añadimos sesgo o no.</li>
<li><code>adjr2</code> para Adjusted r-squared.</li>
<li><code>cp</code> para Mallows’s CP.</li>
<li><code>bic</code> para Schwartz’s information criterion BIC.</li>
</ul>
<p>Nodemos además que en el modelos que nos piden no hay término independiente (ya que por el contrario habría añadido un <code>1</code> a las variables regresoras ), luego tendremos que hacer <code>intercept = FALSE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>subconjuntos_a_examinar <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>modelo_exhaustivo <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> ., </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>datos,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax=</span> subconjuntos_a_examinar, <span class="co"># para que utilice todos las componentes posibles,</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="cn">FALSE</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>resumen_1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_exhaustivo)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>resumen_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = datos, nvmax = subconjuntos_a_examinar, 
    intercept = FALSE)
10 Variables 
    Forced in Forced out
X2      FALSE      FALSE
X3      FALSE      FALSE
X4      FALSE      FALSE
X5      FALSE      FALSE
X6      FALSE      FALSE
X7      FALSE      FALSE
X8      FALSE      FALSE
X9      FALSE      FALSE
X10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: exhaustive
          X1  X2  X3  X4  X5  X6  X7  X8  X9  X10
1  ( 1 )  " " " " "*" " " " " " " " " " " " " " "
2  ( 1 )  " " "*" "*" " " " " " " " " " " " " " "
3  ( 1 )  "*" "*" "*" " " " " " " " " " " " " " "
4  ( 1 )  "*" "*" "*" " " "*" " " " " " " " " " "
5  ( 1 )  "*" "*" "*" " " " " "*" " " "*" " " " "
6  ( 1 )  "*" "*" " " " " "*" "*" "*" " " " " "*"
7  ( 1 )  "*" "*" "*" " " " " "*" "*" " " "*" "*"
8  ( 1 )  "*" "*" "*" "*" " " "*" "*" "*" "*" " "
9  ( 1 )  "*" "*" "*" "*" "*" "*" " " "*" "*" "*"
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para pintar </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pinta_ajuste <span class="ot">&lt;-</span> <span class="cf">function</span>(y_criterio, label){</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>subconjuntos_a_examinar,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> y_criterio</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot_data)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  y_label <span class="ot">&lt;-</span> label</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(plot_data<span class="sc">$</span>x, plot_data<span class="sc">$</span>y, </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">'Número de variables'</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> y_label)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="mejor-modelo-de-acorde-a-r-cuadrado-ajustado" class="level3">
<h3 class="anchored" data-anchor-id="mejor-modelo-de-acorde-a-r-cuadrado-ajustado">Mejor modelo de acorde a R cuadrado ajustado</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_1<span class="sc">$</span>adjr2, <span class="st">"R2 ajustado"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x         y
1   1 0.8286048
2   2 0.9569257
3   3 0.9678546
4   4 0.9679619
5   5 0.9677913
6   6 0.9677254
7   7 0.9677174
8   8 0.9674060
9   9 0.9671478
10 10 0.9667829</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Se alcanza el máximo con "</span>, <span class="fu">which.max</span>(resumen_1<span class="sc">$</span>adjr2), <span class="st">"parametros"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Se alcanza el máximo con  4 parametros</code></pre>
</div>
</div>
<p>Será mejor donde alcance un máximo, esto es en <span class="math inline">\(p = 4\)</span> es decir utilizando 4 parámetros. Vamos a proceder a analizar los coeficientes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mejores elementos</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Selection Algorithm: exhaustive</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#         X1  X2  X3  X4  X5  X6  X7  X8  X9  X10</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#4  ( 1 )  "*" "*" "*" " " "*" " " " " " " " " " "</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>modelo_r2_a <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3  <span class="sc">+</span> X5 <span class="sc">-</span><span class="dv">1</span>, <span class="at">data=</span>datos)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_r2_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ X1 + X2 + X3 + X5 - 1, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.68557 -0.51999 -0.00382  0.74572  1.95348 

Coefficients:
   Estimate Std. Error t value Pr(&gt;|t|)    
X1  1.18463    0.24565   4.822 5.32e-06 ***
X2  1.01504    0.05303  19.140  &lt; 2e-16 ***
X3  0.86982    0.15119   5.753 1.04e-07 ***
X5  0.02059    0.01788   1.151    0.253    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9905 on 96 degrees of freedom
Multiple R-squared:  0.9692,    Adjusted R-squared:  0.968 
F-statistic: 756.3 on 4 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>y_predit_r2_a <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object=</span>modelo_r2_a, <span class="at">newdata=</span>datos)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>datos2<span class="sc">$</span><span class="st">'Y_r2a'</span> <span class="ot">&lt;-</span> y_predit_r2_a </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos2) <span class="sc">+</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(X1, Y), <span class="at">colour =</span> <span class="st">'black'</span> ) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_ideal), <span class="at">colour =</span> <span class="st">'red'</span> ) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_r2a), <span class="at">colour =</span> <span class="st">'green'</span> )</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Como vemos más variables lo que hacen es acercarse al ruido.</p>
</section>
<section id="cp" class="level3">
<h3 class="anchored" data-anchor-id="cp">Cp</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_1<span class="sc">$</span>cp, <span class="st">"Cp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x           y
1   1 412.8247879
2   2  31.0815100
3   3  -0.1295806
4   4   0.5924715
5   5   2.1159807
6   6   3.3327617
7   7   4.3835952
8   8   6.2740547
9   9   8.0003139
10 10  10.0000000</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Con el criterio CP, el mejor modelo tiene "</span>, <span class="fu">which.min</span>(resumen_1<span class="sc">$</span>cp), <span class="st">"parametros</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Con el criterio CP, el mejor modelo tiene  3 parametros</code></pre>
</div>
</div>
<p>Vemos que con este criterio alcanza un mínimo en tres variables. es decir que el mejor de los resultados sería</p>
<pre><code>Selection Algorithm: exhaustive
         X1  X2  X3  X4  X5  X6  X7  X8  X9  X10
3  ( 1 )  "*" "*" "*" " " " " " " " " " " " " " "</code></pre>
<p>que si entrenamos obtendríamos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>modelo_cp<span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3  <span class="sc">-</span><span class="dv">1</span>, <span class="at">data=</span>datos)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_cp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ X1 + X2 + X3 - 1, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.61090 -0.54234  0.02662  0.74564  2.00549 

Coefficients:
   Estimate Std. Error t value Pr(&gt;|t|)    
X1  0.97666    0.16672   5.858 6.41e-08 ***
X2  1.00906    0.05287  19.087  &lt; 2e-16 ***
X3  1.03788    0.03935  26.377  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9922 on 97 degrees of freedom
Multiple R-squared:  0.9688,    Adjusted R-squared:  0.9679 
F-statistic:  1005 on 3 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>y_predit_cp <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object=</span>modelo_cp, <span class="at">newdata=</span>datos)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>datos2<span class="sc">$</span><span class="st">'Y_cp'</span> <span class="ot">&lt;-</span> y_predit_cp </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos2) <span class="sc">+</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(X1, Y), <span class="at">colour =</span> <span class="st">'black'</span> ) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_ideal), <span class="at">colour =</span> <span class="st">'red'</span> ) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_cp), <span class="at">colour =</span> <span class="st">'green'</span> )</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bic" class="level3">
<h3 class="anchored" data-anchor-id="bic">BIC</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_1<span class="sc">$</span>bic, <span class="st">"Bic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x         y
1   1 -172.7782
2   2 -307.2928
3   3 -332.9790
4   4 -329.7446
5   5 -325.6553
6   6 -321.9040
7   7 -318.3436
8   8 -313.8596
9   9 -309.5582
10 10 -304.9534</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Con el criterio BIC, el mejor modelo tiene "</span>, <span class="fu">which.min</span>(resumen_1<span class="sc">$</span>bic), <span class="st">"parametros</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Con el criterio BIC, el mejor modelo tiene  3 parametros</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_exhaustivo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = datos, nvmax = subconjuntos_a_examinar, 
    intercept = FALSE)
10 Variables 
    Forced in Forced out
X2      FALSE      FALSE
X3      FALSE      FALSE
X4      FALSE      FALSE
X5      FALSE      FALSE
X6      FALSE      FALSE
X7      FALSE      FALSE
X8      FALSE      FALSE
X9      FALSE      FALSE
X10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: exhaustive
          X1  X2  X3  X4  X5  X6  X7  X8  X9  X10
1  ( 1 )  " " " " "*" " " " " " " " " " " " " " "
2  ( 1 )  " " "*" "*" " " " " " " " " " " " " " "
3  ( 1 )  "*" "*" "*" " " " " " " " " " " " " " "
4  ( 1 )  "*" "*" "*" " " "*" " " " " " " " " " "
5  ( 1 )  "*" "*" "*" " " " " "*" " " "*" " " " "
6  ( 1 )  "*" "*" " " " " "*" "*" "*" " " " " "*"
7  ( 1 )  "*" "*" "*" " " " " "*" "*" " " "*" "*"
8  ( 1 )  "*" "*" "*" "*" " " "*" "*" "*" "*" " "
9  ( 1 )  "*" "*" "*" "*" "*" "*" " " "*" "*" "*"
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>modelo_bic<span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">-</span><span class="dv">1</span>, <span class="at">data=</span>datos)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ X1 + X2 + X3 - 1, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.61090 -0.54234  0.02662  0.74564  2.00549 

Coefficients:
   Estimate Std. Error t value Pr(&gt;|t|)    
X1  0.97666    0.16672   5.858 6.41e-08 ***
X2  1.00906    0.05287  19.087  &lt; 2e-16 ***
X3  1.03788    0.03935  26.377  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9922 on 97 degrees of freedom
Multiple R-squared:  0.9688,    Adjusted R-squared:  0.9679 
F-statistic:  1005 on 3 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>y_predit_bic <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object=</span>modelo_bic, <span class="at">newdata=</span>datos)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>datos2<span class="sc">$</span><span class="st">'Y_bic'</span> <span class="ot">&lt;-</span> y_predit_bic </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos2) <span class="sc">+</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(X1, Y), <span class="at">colour =</span> <span class="st">'black'</span> ) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_ideal), <span class="at">colour =</span> <span class="st">'red'</span> ) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_bic), <span class="at">colour =</span> <span class="st">'green'</span> )</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="usando-ahora-el-método-iterativo" class="level2">
<h2 class="anchored" data-anchor-id="usando-ahora-el-método-iterativo">Usando ahora el método iterativo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>modelo_iterativo_delante <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> ., </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>datos, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"forward"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> subconjuntos_a_examinar,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="cn">FALSE</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>resumen_2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_iterativo_delante)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>resumen_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = datos, method = "forward", nvmax = subconjuntos_a_examinar, 
    intercept = FALSE)
10 Variables 
    Forced in Forced out
X2      FALSE      FALSE
X3      FALSE      FALSE
X4      FALSE      FALSE
X5      FALSE      FALSE
X6      FALSE      FALSE
X7      FALSE      FALSE
X8      FALSE      FALSE
X9      FALSE      FALSE
X10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: forward
          X1  X2  X3  X4  X5  X6  X7  X8  X9  X10
1  ( 1 )  " " " " "*" " " " " " " " " " " " " " "
2  ( 1 )  " " "*" "*" " " " " " " " " " " " " " "
3  ( 1 )  "*" "*" "*" " " " " " " " " " " " " " "
4  ( 1 )  "*" "*" "*" " " "*" " " " " " " " " " "
5  ( 1 )  "*" "*" "*" " " "*" " " " " " " " " "*"
6  ( 1 )  "*" "*" "*" " " "*" " " "*" " " " " "*"
7  ( 1 )  "*" "*" "*" " " "*" "*" "*" " " " " "*"
8  ( 1 )  "*" "*" "*" " " "*" "*" "*" " " "*" "*"
9  ( 1 )  "*" "*" "*" "*" "*" "*" "*" " " "*" "*"
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
</div>
<p>Observaciones:</p>
<p>Como vemos ahora las variables seleccionadas para <span class="math inline">\(p\)</span> parámetros están incluidas en el modelo con <span class="math inline">\(p+1\)</span> parámetros. Esto es lo esperado ya que es el comportamiento de forward con el fin de mejorar el rendimiento.</p>
<section id="mejor-modelo-de-acorde-a-r-cuadrado-ajustado-con-modelo-iterativo-hacia-delante" class="level3">
<h3 class="anchored" data-anchor-id="mejor-modelo-de-acorde-a-r-cuadrado-ajustado-con-modelo-iterativo-hacia-delante">Mejor modelo de acorde a R cuadrado ajustado con modelo iterativo hacia delante</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_2<span class="sc">$</span>adjr2, <span class="st">"R2 ajustado"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x         y
1   1 0.8286048
2   2 0.9569257
3   3 0.9678546
4   4 0.9679619
5   5 0.9677077
6   6 0.9674817
7   7 0.9676667
8   8 0.9673671
9   9 0.9670145
10 10 0.9667829</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Se alcanza el máximo con "</span>, <span class="fu">which.max</span>(resumen_2<span class="sc">$</span>adjr2), <span class="st">"parametros"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Se alcanza el máximo con  4 parametros</code></pre>
</div>
</div>
<p>Será mejor donde alcance un máximo, esto es en <span class="math inline">\(p = 8\)</span> es decir utilizando 8 parámetros. Vamos a proceder a analizar los coeficientes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#          X1  X2  X3  X4  X5  X6  X7  X8  X9  X10</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#4  ( 1 )  "*" "*" "*" " " "*" " " " " " " " " " "</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>modelo_r2_a <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span>  X5 <span class="sc">+-</span><span class="dv">1</span>, <span class="at">data=</span>datos)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_r2_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ X1 + X2 + X3 + X5 + -1, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.68557 -0.51999 -0.00382  0.74572  1.95348 

Coefficients:
   Estimate Std. Error t value Pr(&gt;|t|)    
X1  1.18463    0.24565   4.822 5.32e-06 ***
X2  1.01504    0.05303  19.140  &lt; 2e-16 ***
X3  0.86982    0.15119   5.753 1.04e-07 ***
X5  0.02059    0.01788   1.151    0.253    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9905 on 96 degrees of freedom
Multiple R-squared:  0.9692,    Adjusted R-squared:  0.968 
F-statistic: 756.3 on 4 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>y_predit_r2_a <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object=</span>modelo_r2_a, <span class="at">newdata=</span>datos)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>datos2<span class="sc">$</span><span class="st">'Y_r2a'</span> <span class="ot">&lt;-</span> y_predit_r2_a </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos2) <span class="sc">+</span> </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(X1, Y), <span class="at">colour =</span> <span class="st">'black'</span> ) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_ideal), <span class="at">colour =</span> <span class="st">'red'</span> ) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_r2a), <span class="at">colour =</span> <span class="st">'green'</span> )</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Como vemos más variables lo que hacen es acercarse al ruido. El error <code>djusted R-squared:  0.968</code> coincide con el del criterio.</p>
</section>
<section id="cp-1" class="level3">
<h3 class="anchored" data-anchor-id="cp-1">Cp</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_2<span class="sc">$</span>cp, <span class="st">"Cp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x           y
1   1 412.8247879
2   2  31.0815100
3   3  -0.1295806
4   4   0.5924715
5   5   2.3549212
6   6   4.0223717
7   7   4.5256530
8   8   6.3819508
9   9   8.3654007
10 10  10.0000000</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Con el criterio CP, el mejor modelo tiene "</span>, <span class="fu">which.min</span>(resumen_2<span class="sc">$</span>cp), <span class="st">"parametros</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Con el criterio CP, el mejor modelo tiene  3 parametros</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_iterativo_delante)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = datos, method = "forward", nvmax = subconjuntos_a_examinar, 
    intercept = FALSE)
10 Variables 
    Forced in Forced out
X2      FALSE      FALSE
X3      FALSE      FALSE
X4      FALSE      FALSE
X5      FALSE      FALSE
X6      FALSE      FALSE
X7      FALSE      FALSE
X8      FALSE      FALSE
X9      FALSE      FALSE
X10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: forward
          X1  X2  X3  X4  X5  X6  X7  X8  X9  X10
1  ( 1 )  " " " " "*" " " " " " " " " " " " " " "
2  ( 1 )  " " "*" "*" " " " " " " " " " " " " " "
3  ( 1 )  "*" "*" "*" " " " " " " " " " " " " " "
4  ( 1 )  "*" "*" "*" " " "*" " " " " " " " " " "
5  ( 1 )  "*" "*" "*" " " "*" " " " " " " " " "*"
6  ( 1 )  "*" "*" "*" " " "*" " " "*" " " " " "*"
7  ( 1 )  "*" "*" "*" " " "*" "*" "*" " " " " "*"
8  ( 1 )  "*" "*" "*" " " "*" "*" "*" " " "*" "*"
9  ( 1 )  "*" "*" "*" "*" "*" "*" "*" " " "*" "*"
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
</div>
<p>Vemos que con este criterio alcanza un mínimo en tres variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>modelo_cp<span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3  <span class="sc">-</span><span class="dv">1</span>, <span class="at">data=</span>datos)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_cp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ X1 + X2 + X3 - 1, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.61090 -0.54234  0.02662  0.74564  2.00549 

Coefficients:
   Estimate Std. Error t value Pr(&gt;|t|)    
X1  0.97666    0.16672   5.858 6.41e-08 ***
X2  1.00906    0.05287  19.087  &lt; 2e-16 ***
X3  1.03788    0.03935  26.377  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9922 on 97 degrees of freedom
Multiple R-squared:  0.9688,    Adjusted R-squared:  0.9679 
F-statistic:  1005 on 3 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>y_predit_cp <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object=</span>modelo_cp, <span class="at">newdata=</span>datos)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>datos2<span class="sc">$</span><span class="st">'Y_cp'</span> <span class="ot">&lt;-</span> y_predit_cp </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos2) <span class="sc">+</span> </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(X1, Y), <span class="at">colour =</span> <span class="st">'black'</span> ) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_ideal), <span class="at">colour =</span> <span class="st">'red'</span> ) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_cp), <span class="at">colour =</span> <span class="st">'green'</span> )</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bic-1" class="level3">
<h3 class="anchored" data-anchor-id="bic-1">BIC</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_2<span class="sc">$</span>bic, <span class="st">"Bic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x         y
1   1 -172.7782
2   2 -307.2928
3   3 -332.9790
4   4 -329.7446
5   5 -325.3963
6   6 -321.1518
7   7 -318.1865
8   8 -313.7402
9   9 -309.1533
10 10 -304.9534</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Con el criterio BIC, el mejor modelo tiene "</span>, <span class="fu">which.min</span>(resumen_1<span class="sc">$</span>bic), <span class="st">"parametros</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Con el criterio BIC, el mejor modelo tiene  3 parametros</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_iterativo_delante)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = datos, method = "forward", nvmax = subconjuntos_a_examinar, 
    intercept = FALSE)
10 Variables 
    Forced in Forced out
X2      FALSE      FALSE
X3      FALSE      FALSE
X4      FALSE      FALSE
X5      FALSE      FALSE
X6      FALSE      FALSE
X7      FALSE      FALSE
X8      FALSE      FALSE
X9      FALSE      FALSE
X10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: forward
          X1  X2  X3  X4  X5  X6  X7  X8  X9  X10
1  ( 1 )  " " " " "*" " " " " " " " " " " " " " "
2  ( 1 )  " " "*" "*" " " " " " " " " " " " " " "
3  ( 1 )  "*" "*" "*" " " " " " " " " " " " " " "
4  ( 1 )  "*" "*" "*" " " "*" " " " " " " " " " "
5  ( 1 )  "*" "*" "*" " " "*" " " " " " " " " "*"
6  ( 1 )  "*" "*" "*" " " "*" " " "*" " " " " "*"
7  ( 1 )  "*" "*" "*" " " "*" "*" "*" " " " " "*"
8  ( 1 )  "*" "*" "*" " " "*" "*" "*" " " "*" "*"
9  ( 1 )  "*" "*" "*" "*" "*" "*" "*" " " "*" "*"
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>modelo_bic<span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span>  X3  <span class="sc">-</span><span class="dv">1</span>, <span class="at">data=</span>datos)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ X1 + X2 + X3 - 1, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.61090 -0.54234  0.02662  0.74564  2.00549 

Coefficients:
   Estimate Std. Error t value Pr(&gt;|t|)    
X1  0.97666    0.16672   5.858 6.41e-08 ***
X2  1.00906    0.05287  19.087  &lt; 2e-16 ***
X3  1.03788    0.03935  26.377  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9922 on 97 degrees of freedom
Multiple R-squared:  0.9688,    Adjusted R-squared:  0.9679 
F-statistic:  1005 on 3 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>y_predit_bic <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object=</span>modelo_bic, <span class="at">newdata=</span>datos)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>datos2<span class="sc">$</span><span class="st">'Y_bic'</span> <span class="ot">&lt;-</span> y_predit_bic </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos2) <span class="sc">+</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(X1, Y), <span class="at">colour =</span> <span class="st">'black'</span> ) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_ideal), <span class="at">colour =</span> <span class="st">'red'</span> ) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(X1, Y_bic), <span class="at">colour =</span> <span class="st">'green'</span> )</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'Los coefficientes del modelo son'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Los coefficientes del modelo son"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(modelo_bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       X1        X2        X3 
0.9766564 1.0090610 1.0378754 </code></pre>
</div>
</div>
</section>
</section>
<section id="lasso" class="level2">
<h2 class="anchored" data-anchor-id="lasso">Lasso</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ramify':

    tril, triu</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded glmnet 4.1-6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> datos[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)]</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> datos<span class="sc">$</span>y</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>modelo_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">intercept=</span><span class="cn">FALSE</span>)   <span class="co"># alpha = 1 (lasso); alpha = 0 (ridge)</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_lasso, <span class="at">xvar=</span><span class="st">'lambda'</span>, <span class="at">label=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(modelo_lasso, <span class="at">s =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>11 x 1 sparse Matrix of class "dgCMatrix"
                     s1
(Intercept) .          
X1          1.009813169
X2          0.957280286
X3          0.961825895
X4          .          
X5          0.006891391
X6          .          
X7          .          
X8          .          
X9          .          
X10         .          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#help(coef)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La ventaja que tiene lasso es que permite eliminar ciertos coeficientes esto queda de manifiesto en que la mayoría son nulos.</p>
</section>
<section id="genera-ahora-las-respuestas-a-partir-del-modelo" class="level2">
<h2 class="anchored" data-anchor-id="genera-ahora-las-respuestas-a-partir-del-modelo">Genera ahora las respuestas a partir del modelo</h2>
<p><span class="math display">\[
Y = X^7 + \epsilon.
\]</span></p>
<section id="generación-de-los-datos" class="level3">
<h3 class="anchored" data-anchor-id="generación-de-los-datos">Generación de los datos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generamos las potencias</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">'1'</span><span class="ot">=</span>X)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  datos[i] <span class="ot">&lt;-</span> datos[<span class="dv">1</span>]<span class="sc">*</span>datos[i<span class="dv">-1</span>]</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo1 </span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">unlist</span>(</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>(</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>    datos[<span class="dv">7</span>] <span class="sc">+</span> <span class="fu">error_distribution</span>(n)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span><span class="st">'y'</span> <span class="ot">&lt;-</span> Y</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos) <span class="ot">&lt;-</span> nombre_variables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelo-óptimo-dentro-de-submodelos" class="level3">
<h3 class="anchored" data-anchor-id="modelo-óptimo-dentro-de-submodelos">Modelo óptimo dentro de submodelos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>modelo_exhaustivo <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> ., </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>datos,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> subconjuntos_a_examinar</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>resumen_1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_exhaustivo)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>resumen_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = datos, nvmax = subconjuntos_a_examinar)
10 Variables  (and intercept)
    Forced in Forced out
X1      FALSE      FALSE
X2      FALSE      FALSE
X3      FALSE      FALSE
X4      FALSE      FALSE
X5      FALSE      FALSE
X6      FALSE      FALSE
X7      FALSE      FALSE
X8      FALSE      FALSE
X9      FALSE      FALSE
X10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: exhaustive
          X1  X2  X3  X4  X5  X6  X7  X8  X9  X10
1  ( 1 )  " " " " " " " " " " " " "*" " " " " " "
2  ( 1 )  " " " " " " " " "*" " " "*" " " " " " "
3  ( 1 )  "*" " " "*" " " " " " " "*" " " " " " "
4  ( 1 )  " " " " "*" " " "*" " " "*" " " "*" " "
5  ( 1 )  " " " " "*" "*" "*" " " "*" " " "*" " "
6  ( 1 )  " " "*" "*" " " "*" " " "*" " " "*" "*"
7  ( 1 )  " " " " "*" "*" "*" " " "*" "*" "*" "*"
8  ( 1 )  " " "*" "*" "*" "*" "*" "*" "*" "*" " "
9  ( 1 )  "*" "*" "*" "*" "*" "*" "*" "*" "*" " "
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
</div>
<p>Vemos que ahora a pesar de estar en un método exhaustivo, <span class="math inline">\(X^7\)</span> (el que sabemos que forma parte del modelo ideal) se encuentra en todos. Esto puede entenderse como que al ser solo una <em>es más simple que la encuentre</em> y que no se compense con nada.</p>
</section>
<section id="submodelos-óptimos" class="level3">
<h3 class="anchored" data-anchor-id="submodelos-óptimos">Submodelos óptimos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Submodelos óptimos"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Submodelos óptimos"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_1<span class="sc">$</span>adjr2, <span class="st">"R2 ajustado"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x         y
1   1 0.9999694
2   2 0.9999699
3   3 0.9999703
4   4 0.9999714
5   5 0.9999727
6   6 0.9999725
7   7 0.9999723
8   8 0.9999721
9   9 0.9999719
10 10 0.9999716</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Se alcanza el máximo con "</span>, <span class="fu">which.max</span>(resumen_1<span class="sc">$</span>adjr2), <span class="st">"parametros"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Se alcanza el máximo con  5 parametros</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_1<span class="sc">$</span>cp, <span class="st">"Cp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x         y
1   1  9.602617
2   2  8.876994
3   3  8.307524
4   4  5.540267
5   5  2.425076
6   6  4.203833
7   7  5.638432
8   8  7.333217
9   9  9.123479
10 10 11.000000</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Con el criterio CP, el mejor modelo tiene "</span>, <span class="fu">which.min</span>(resumen_1<span class="sc">$</span>cp), <span class="st">"parametros</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Con el criterio CP, el mejor modelo tiene  5 parametros</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_1<span class="sc">$</span>bic, <span class="st">"Bic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x         y
1   1 -1031.252
2   2 -1029.261
3   3 -1027.186
4   4 -1027.450
5   5 -1028.347
6   6 -1023.987
7   7 -1020.011
8   8 -1015.746
9   9 -1011.376
10 10 -1006.910</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Con el criterio BIC, el mejor modelo tiene "</span>, <span class="fu">which.min</span>(resumen_1<span class="sc">$</span>bic), <span class="st">"parametros</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Con el criterio BIC, el mejor modelo tiene  1 parametros</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_exhaustivo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = datos, nvmax = subconjuntos_a_examinar)
10 Variables  (and intercept)
    Forced in Forced out
X1      FALSE      FALSE
X2      FALSE      FALSE
X3      FALSE      FALSE
X4      FALSE      FALSE
X5      FALSE      FALSE
X6      FALSE      FALSE
X7      FALSE      FALSE
X8      FALSE      FALSE
X9      FALSE      FALSE
X10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: exhaustive
          X1  X2  X3  X4  X5  X6  X7  X8  X9  X10
1  ( 1 )  " " " " " " " " " " " " "*" " " " " " "
2  ( 1 )  " " " " " " " " "*" " " "*" " " " " " "
3  ( 1 )  "*" " " "*" " " " " " " "*" " " " " " "
4  ( 1 )  " " " " "*" " " "*" " " "*" " " "*" " "
5  ( 1 )  " " " " "*" "*" "*" " " "*" " " "*" " "
6  ( 1 )  " " "*" "*" " " "*" " " "*" " " "*" "*"
7  ( 1 )  " " " " "*" "*" "*" " " "*" "*" "*" "*"
8  ( 1 )  " " "*" "*" "*" "*" "*" "*" "*" "*" " "
9  ( 1 )  "*" "*" "*" "*" "*" "*" "*" "*" "*" " "
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
</div>
</section>
<section id="submodelos-utilizando-un-método-iterativo" class="level3">
<h3 class="anchored" data-anchor-id="submodelos-utilizando-un-método-iterativo">Submodelos utilizando un método iterativo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>modelo_iterativo_delante <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> ., </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>datos, </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"forward"</span>,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> subconjuntos_a_examinar</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>resumen_2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_iterativo_delante)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>resumen_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = datos, method = "forward", nvmax = subconjuntos_a_examinar)
10 Variables  (and intercept)
    Forced in Forced out
X1      FALSE      FALSE
X2      FALSE      FALSE
X3      FALSE      FALSE
X4      FALSE      FALSE
X5      FALSE      FALSE
X6      FALSE      FALSE
X7      FALSE      FALSE
X8      FALSE      FALSE
X9      FALSE      FALSE
X10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: forward
          X1  X2  X3  X4  X5  X6  X7  X8  X9  X10
1  ( 1 )  " " " " " " " " " " " " "*" " " " " " "
2  ( 1 )  " " " " " " " " "*" " " "*" " " " " " "
3  ( 1 )  " " " " " " " " "*" " " "*" " " "*" " "
4  ( 1 )  " " " " "*" " " "*" " " "*" " " "*" " "
5  ( 1 )  " " " " "*" "*" "*" " " "*" " " "*" " "
6  ( 1 )  "*" " " "*" "*" "*" " " "*" " " "*" " "
7  ( 1 )  "*" " " "*" "*" "*" " " "*" " " "*" "*"
8  ( 1 )  "*" " " "*" "*" "*" " " "*" "*" "*" "*"
9  ( 1 )  "*" "*" "*" "*" "*" " " "*" "*" "*" "*"
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Submodelos utilizando el método iterativo </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Submodelos utilizando el método iterativo \n"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_2<span class="sc">$</span>adjr2, <span class="st">"R2 ajustado"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x         y
1   1 0.9999694
2   2 0.9999699
3   3 0.9999701
4   4 0.9999714
5   5 0.9999727
6   6 0.9999724
7   7 0.9999721
8   8 0.9999721
9   9 0.9999718
10 10 0.9999716</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Se alcanza el máximo con "</span>, <span class="fu">which.max</span>(resumen_2<span class="sc">$</span>adjr2), <span class="st">"parametros"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Se alcanza el máximo con  5 parametros</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_2<span class="sc">$</span>cp, <span class="st">"Cp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x         y
1   1  9.602617
2   2  8.876994
3   3  9.080660
4   4  5.540267
5   5  2.425076
6   6  4.303052
7   7  6.235477
8   8  7.467563
9   9  9.298214
10 10 11.000000</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Con el criterio CP, el mejor modelo tiene "</span>, <span class="fu">which.min</span>(resumen_2<span class="sc">$</span>cp), <span class="st">"parametros</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Con el criterio CP, el mejor modelo tiene  5 parametros</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pinta_ajuste</span>(resumen_2<span class="sc">$</span>bic, <span class="st">"Bic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x         y
1   1 -1031.252
2   2 -1029.261
3   3 -1026.418
4   4 -1027.450
5   5 -1028.347
6   6 -1023.877
7   7 -1019.347
8   8 -1015.596
9   9 -1011.180
10 10 -1006.910</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Con el criterio BIC, el mejor modelo tiene "</span>, <span class="fu">which.min</span>(resumen_1<span class="sc">$</span>bic), <span class="st">"parametros</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Con el criterio BIC, el mejor modelo tiene  1 parametros</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_iterativo_delante)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = datos, method = "forward", nvmax = subconjuntos_a_examinar)
10 Variables  (and intercept)
    Forced in Forced out
X1      FALSE      FALSE
X2      FALSE      FALSE
X3      FALSE      FALSE
X4      FALSE      FALSE
X5      FALSE      FALSE
X6      FALSE      FALSE
X7      FALSE      FALSE
X8      FALSE      FALSE
X9      FALSE      FALSE
X10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: forward
          X1  X2  X3  X4  X5  X6  X7  X8  X9  X10
1  ( 1 )  " " " " " " " " " " " " "*" " " " " " "
2  ( 1 )  " " " " " " " " "*" " " "*" " " " " " "
3  ( 1 )  " " " " " " " " "*" " " "*" " " "*" " "
4  ( 1 )  " " " " "*" " " "*" " " "*" " " "*" " "
5  ( 1 )  " " " " "*" "*" "*" " " "*" " " "*" " "
6  ( 1 )  "*" " " "*" "*" "*" " " "*" " " "*" " "
7  ( 1 )  "*" " " "*" "*" "*" " " "*" " " "*" "*"
8  ( 1 )  "*" " " "*" "*" "*" " " "*" "*" "*" "*"
9  ( 1 )  "*" "*" "*" "*" "*" " " "*" "*" "*" "*"
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
</div>
</section>
</section>
<section id="lasso-1" class="level2">
<h2 class="anchored" data-anchor-id="lasso-1">Lasso</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> datos[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)]</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> datos<span class="sc">$</span>y</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>modelo_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">intercept=</span><span class="cn">FALSE</span>)   <span class="co"># alpha = 1 (lasso); alpha = 0 (ridge)</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_lasso, <span class="at">xvar=</span><span class="st">'lambda'</span>, <span class="at">label=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plotCoef(x$beta, lambda = x$lambda, df = x$df, dev = x$dev.ratio, : 1
or less nonzero coefficients; glmnet plot is not meaningful</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ejercicio_09_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(modelo_lasso, <span class="at">s =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>11 x 1 sparse Matrix of class "dgCMatrix"
                   s1
(Intercept) .        
X1          .        
X2          .        
X3          .        
X4          .        
X5          .        
X6          .        
X7          0.9708107
X8          .        
X9          .        
X10         .        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#help(coef)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>